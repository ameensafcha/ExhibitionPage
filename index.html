<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAFCHA Custom Video Player</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
  }

  /* Video Container Styles */
  #videoContainer {
    position: relative;
    background: black;
    overflow: hidden;
    width: 100%;
    max-width: 1100px;
    border-radius: 16px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  /* Fullscreen Specifics */
  #videoContainer:fullscreen {
    border-radius: 0;
    width: 100vw;
    height: 100vh;
  }
  
  #videoContainer.fullscreen-mode {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9999;
    border-radius: 0;
  }

  #videoContainer video {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  /* Lock Button - Always on Top */
  #lockBtn {
    z-index: 100; 
    transition: all 0.3s ease;
  }

  /* UI Elements (Controls & FS Button) */
  .ui-element {
    transition: opacity 0.3s ease, visibility 0.3s;
    opacity: 0; 
    visibility: hidden;
    z-index: 50;
  }

  /* Show UI when active */
  #videoContainer.user-active .ui-element {
    opacity: 1;
    visibility: visible;
  }

  /* LOCKED STATE: Force hide UI */
  #videoContainer.locked .ui-element {
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }

  /* Custom Range Input Styling */
  input[type=range] {
    -webkit-appearance: none;
    background: transparent;
    cursor: pointer;
  }
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    height: 16px;
    width: 16px;
    border-radius: 50%;
    background: #ffffff;
    margin-top: -6px;
    box-shadow: 0 0 2px rgba(0,0,0,0.5);
  }
  input[type=range]::-webkit-slider-runnable-track {
    width: 100%;
    height: 4px;
    cursor: pointer;
    background: rgba(255,255,255,0.3);
    border-radius: 2px;
  }
</style>
</head>
<body>

  <div id="videoContainer">
    <video 
      id="videoPlayer"
      autoplay
      muted
      loop
      playsinline
      poster="https://images.unsplash.com/photo-1574267432644-f610c0b5c135?w=1024"
    >
      <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>

    <button id="lockBtn" class="absolute top-5 right-5 bg-black/60 hover:bg-black/80 text-white p-3 rounded-full backdrop-blur-sm">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
    </button>

    <button id="fsBtn" class="ui-element absolute bottom-5 right-5 bg-black/60 hover:bg-black/80 text-white px-4 py-2 rounded-lg backdrop-blur-sm flex items-center gap-2">
      <span>â›¶</span>
    </button>

    <div id="controls" class="ui-element absolute bottom-5 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md px-6 py-3 rounded-xl flex items-center gap-4 w-[90%] max-w-md">
      <button id="playPauseBtn" class="text-white hover:text-green-400 font-bold min-w-[50px]">Pause</button>
      <span id="currentTime" class="text-white text-xs font-mono">0:00</span>
      <input type="range" id="progress" min="0" max="100" value="0" class="flex-grow h-1">
      <span id="duration" class="text-white text-xs font-mono">0:00</span>
    </div>
  </div>

<script>
const video = document.getElementById('videoPlayer');
const container = document.getElementById('videoContainer');
const lockBtn = document.getElementById('lockBtn');
const fsBtn = document.getElementById('fsBtn');
const playPauseBtn = document.getElementById('playPauseBtn');
const progress = document.getElementById('progress');
const currentTimeDisplay = document.getElementById('currentTime');
const durationDisplay = document.getElementById('duration');

let isLocked = false;
let activityTimeout;

// 1. LOCK LOGIC
lockBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  isLocked = !isLocked;

  if (isLocked) {
    container.classList.add('locked');
    lockBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>`;
    lockBtn.classList.add('bg-white');
    lockBtn.classList.remove('text-white');
  } else {
    container.classList.remove('locked');
    lockBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 9.9-1"></path></svg>`;
    lockBtn.classList.remove('bg-white');
    lockBtn.classList.add('text-white');
    showControls();
  }
});

// 2. CONTROLS VISIBILITY
function showControls() {
  if (isLocked) return;

  container.classList.add('user-active');
  
  clearTimeout(activityTimeout);
  activityTimeout = setTimeout(() => {
    if (!video.paused) {
      container.classList.remove('user-active');
    }
  }, 3000);
}

container.addEventListener('mousemove', showControls);
container.addEventListener('click', showControls);
container.addEventListener('touchstart', showControls);

// 3. FULLSCREEN LOGIC
fsBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  toggleFullscreen();
});

function toggleFullscreen() {
  if (!document.fullscreenElement) {
    if (container.requestFullscreen) {
      container.requestFullscreen();
    } else {
      container.classList.toggle('fullscreen-mode');
    }
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen();
    }
    container.classList.remove('fullscreen-mode');
  }
}

// Play/Pause Logic
video.addEventListener('play', () => playPauseBtn.textContent = 'Pause');
video.addEventListener('pause', () => playPauseBtn.textContent = 'Play');

playPauseBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  video.paused ? video.play() : video.pause();
});

// 4. PROGRESS BAR & TIME
video.addEventListener('timeupdate', () => {
  const current = video.currentTime;
  const duration = video.duration || 0;
  
  if (!isNaN(duration)) {
    progress.value = (current / duration) * 100;
    currentTimeDisplay.textContent = formatTime(current);
    durationDisplay.textContent = formatTime(duration);
  }
});

progress.addEventListener('input', (e) => {
  e.stopPropagation();
  const duration = video.duration || 0;
  video.currentTime = (progress.value / 100) * duration;
});

function formatTime(seconds) {
  const m = Math.floor(seconds / 60);
  const s = Math.floor(seconds % 60);
  return `${m}:${s.toString().padStart(2, '0')}`;
}
</script>
</body>
</html>